(()=>{var t={1424:(t,e,r)=>{"use strict";r.d(e,{Z:()=>u});var n=r(8081),o=r.n(n),i=r(3645),a=r.n(i)()(o());a.push([t.id,"@import url(https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap);"]),a.push([t.id,"@import url(https://fonts.googleapis.com/css2?family=Noto+Colr+Emoji+Glyf);"]),a.push([t.id,"\n/* noinspection CssUnknownTarget */\n\n/* noinspection CssUnknownTarget */\n\nhtml, body {\n    width: 100vw;\n    height: 100vh;\n    padding: 0;\n    margin: 0;\n    overflow: hidden;\n    background: #111;\n}\n\ncanvas {\n    outline: none;\n}\n",""]);const u=a},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r="",n=void 0!==e[5];return e[4]&&(r+="@supports (".concat(e[4],") {")),e[2]&&(r+="@media ".concat(e[2]," {")),n&&(r+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),r+=t(e),n&&(r+="}"),e[2]&&(r+="}"),e[4]&&(r+="}"),r})).join("")},e.i=function(t,r,n,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(n)for(var u=0;u<this.length;u++){var s=this[u][0];null!=s&&(a[s]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);n&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),r&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=r):l[2]=r),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),e.push(l))}},e}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},6377:(t,e,r)=>{var n=r(4832),o=r(8652),i=r(801),a=r(2030),u=r(3618),s=r(9049),c=r(1971);c.alea=n,c.xor128=o,c.xorwow=i,c.xorshift7=a,c.xor4096=u,c.tychei=s,t.exports=c},4832:function(t,e,r){var n;!function(t,o,i){function a(t){var e,r=this,n=(e=4022871197,function(t){t=String(t);for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)});r.next=function(){var t=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(t),r.s0<0&&(r.s0+=1),r.s1-=n(t),r.s1<0&&(r.s1+=1),r.s2-=n(t),r.s2<0&&(r.s2+=1),n=null}function u(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function s(t,e){var r=new a(t),n=e&&e.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,n&&("object"==typeof n&&u(n,r),o.state=function(){return u(r,{})}),o}o&&o.exports?o.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(e,r,e,o))||(o.exports=n):this.alea=s}(0,t=r.nmd(t),r.amdD)},9049:function(t,e,r){var n;!function(t,o,i){function a(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,o=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^o,o=o-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^o,e.a=o-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}function u(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function s(t,e){var r=new a(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&u(n,r),o.state=function(){return u(r,{})}),o}o&&o.exports?o.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(e,r,e,o))||(o.exports=n):this.tychei=s}(0,t=r.nmd(t),r.amdD)},8652:function(t,e,r){var n;!function(t,o,i){function a(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}function u(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function s(t,e){var r=new a(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&u(n,r),o.state=function(){return u(r,{})}),o}o&&o.exports?o.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(e,r,e,o))||(o.exports=n):this.xor128=s}(0,t=r.nmd(t),r.amdD)},3618:function(t,e,r){var n;!function(t,o,i){function a(t){var e=this;e.next=function(){var t,r,n=e.w,o=e.X,i=e.i;return e.w=n=n+1640531527|0,r=o[i+34&127],t=o[i=i+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=o[i]=r^t,e.i=i,r+(n^n>>>16)|0},function(t,e){var r,n,o,i,a,u=[],s=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,s=Math.max(s,e.length)),o=0,i=-32;i<s;++i)e&&(n^=e.charCodeAt((i+32)%e.length)),0===i&&(a=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,i>=0&&(a=a+1640531527|0,o=0==(r=u[127&i]^=n+a)?o+1:0);for(o>=128&&(u[127&(e&&e.length||0)]=-1),o=127,i=512;i>0;--i)n=u[o+34&127],r=u[o=o+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,u[o]=n^r;t.w=a,t.X=u,t.i=o}(e,t)}function u(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function s(t,e){null==t&&(t=+new Date);var r=new a(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&(n.X&&u(n,r),o.state=function(){return u(r,{})}),o}o&&o.exports?o.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(e,r,e,o))||(o.exports=n):this.xor4096=s}(0,t=r.nmd(t),r.amdD)},2030:function(t,e,r){var n;!function(t,o,i){function a(t){var e=this;e.next=function(){var t,r,n=e.x,o=e.i;return t=n[o],r=(t^=t>>>7)^t<<24,r^=(t=n[o+1&7])^t>>>10,r^=(t=n[o+3&7])^t>>>3,r^=(t=n[o+4&7])^t<<7,t=n[o+7&7],r^=(t^=t<<13)^t<<9,n[o]=r,e.i=o+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function u(t,e){return e.x=t.x.slice(),e.i=t.i,e}function s(t,e){null==t&&(t=+new Date);var r=new a(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&(n.x&&u(n,r),o.state=function(){return u(r,{})}),o}o&&o.exports?o.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(e,r,e,o))||(o.exports=n):this.xorshift7=s}(0,t=r.nmd(t),r.amdD)},801:function(t,e,r){var n;!function(t,o,i){function a(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function u(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function s(t,e){var r=new a(t),n=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&u(n,r),o.state=function(){return u(r,{})}),o}o&&o.exports?o.exports=s:r.amdD&&r.amdO?void 0===(n=function(){return s}.call(e,r,e,o))||(o.exports=n):this.xorwow=s}(0,t=r.nmd(t),r.amdD)},1971:function(t,e,r){var n;!function(o,i,a){var u,s=256,c=a.pow(s,6),l=a.pow(2,52),f=2*l,h=s-1;function d(t,e,r){var n=[],h=m(y((e=1==e?{entropy:!0}:e||{}).entropy?[t,b(i)]:null==t?function(){try{var t;return u&&(t=u.randomBytes)?t=t(s):(t=new Uint8Array(s),(o.crypto||o.msCrypto).getRandomValues(t)),b(t)}catch(t){var e=o.navigator,r=e&&e.plugins;return[+new Date,o,r,o.screen,b(i)]}}():t,3),n),d=new p(n),x=function(){for(var t=d.g(6),e=c,r=0;t<l;)t=(t+r)*s,e*=s,r=d.g(1);for(;t>=f;)t/=2,e/=2,r>>>=1;return(t+r)/e};return x.int32=function(){return 0|d.g(4)},x.quick=function(){return d.g(4)/4294967296},x.double=x,m(b(d.S),i),(e.pass||r||function(t,e,r,n){return n&&(n.S&&v(n,d),t.state=function(){return v(d,{})}),r?(a.random=t,e):t})(x,h,"global"in e?e.global:this==a,e.state)}function p(t){var e,r=t.length,n=this,o=0,i=n.i=n.j=0,a=n.S=[];for(r||(t=[r++]);o<s;)a[o]=o++;for(o=0;o<s;o++)a[o]=a[i=h&i+t[o%r]+(e=a[o])],a[i]=e;(n.g=function(t){for(var e,r=0,o=n.i,i=n.j,a=n.S;t--;)e=a[o=h&o+1],r=r*s+a[h&(a[o]=a[i=h&i+e])+(a[i]=e)];return n.i=o,n.j=i,r})(s)}function v(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function y(t,e){var r,n=[],o=typeof t;if(e&&"object"==o)for(r in t)try{n.push(y(t[r],e-1))}catch(t){}return n.length?n:"string"==o?t:t+"\0"}function m(t,e){for(var r,n=t+"",o=0;o<n.length;)e[h&o]=h&(r^=19*e[h&o])+n.charCodeAt(o++);return b(e)}function b(t){return String.fromCharCode.apply(0,t)}if(m(a.random(),i),t.exports){t.exports=d;try{u=r(5042)}catch(t){}}else void 0===(n=function(){return d}.call(e,r,e,t))||(t.exports=n)}("undefined"!=typeof self?self:this,[],Math)},8548:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var n=r(3379),o=r.n(n),i=r(7795),a=r.n(i),u=r(569),s=r.n(u),c=r(3565),l=r.n(c),f=r(9216),h=r.n(f),d=r(4589),p=r.n(d),v=r(1424),y={};y.styleTagTransform=p(),y.setAttributes=l(),y.insert=s().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=h(),o()(v.Z,y);const m=v.Z&&v.Z.locals?v.Z.locals:void 0},3379:t=>{"use strict";var e=[];function r(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function n(t,n){for(var i={},a=[],u=0;u<t.length;u++){var s=t[u],c=n.base?s[0]+n.base:s[0],l=i[c]||0,f="".concat(c," ").concat(l);i[c]=l+1;var h=r(f),d={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==h)e[h].references++,e[h].updater(d);else{var p=o(d,n);n.byIndex=u,e.splice(u,0,{identifier:f,updater:p,references:1})}a.push(f)}return a}function o(t,e){var r=e.domAPI(e);return r.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;r.update(t=e)}else r.remove()}}t.exports=function(t,o){var i=n(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var u=r(i[a]);e[u].references--}for(var s=n(t,o),c=0;c<i.length;c++){var l=r(i[c]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}i=s}}},569:t=>{"use strict";var e={};t.exports=function(t,r){var n=function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,r)=>{"use strict";t.exports=function(t){var e=r.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(r){!function(t,e,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,r)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1811:function(t,e){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.EventBus=void 0,e.EventBus=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=function(n){var i,a;try{for(var u=r(e),s=u.next();!s.done;s=u.next()){var c=(0,s.value)(t,n,o);void 0!==c&&(t=c)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}};return o}},118:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasClearEventHandler=void 0,e.CanvasClearEventHandler=function(t,e){var r=t.canvas,n=t.context;"tick"===e.type&&n.clearRect(0,0,r.width,r.height)}},4345:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChangePreviousUpdateTimeEventHandler=void 0,e.ChangePreviousUpdateTimeEventHandler=function(t,e){"tick"===e.type&&(t.previousUpdateTime=performance.now())}},6301:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DebugInfoEventHandler=void 0;var n=r(1877),o=r(3380);e.DebugInfoEventHandler=function(){var t=!1,e=void 0;return function(r,i){if((0,n.isGameState)(r)&&("keyDown"===i.type&&(e=i.event.code,"F3"===i.event.code&&(t=!t,i.event.preventDefault())),"tick"===i.type&&t)){var a=r.context;a.save(),a.fillStyle="rgba(0, 0, 0, 0.3)",a.fillRect(0,0,.3*r.canvas.width,.4*r.canvas.height),a.beginPath(),a.rect(5,5,.3*r.canvas.width-10,.4*r.canvas.height-10),a.clip(),a.fillStyle="white";var u=performance.now()-r.previousUpdateTime;(0,o.drawText)(a,""+"Time delta: ".concat(Math.round(u),"\n")+"Ticks per second: ".concat(Math.round(1e3/u),"\n")+"Player position: ".concat(r.world.player.coordinates,"\n")+"Camera offset: ".concat(r.cameraOffset,"\n")+"Pressed key: ".concat(e,"\n"),5,5),a.restore()}}}},2417:function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.GameInterfaceEventHandler=void 0;var o=r(6947),i=r(3380),a=r(1184),u=r(1877),s=r(4945),c=r(909),l=64,f="".concat(16,"px ").concat(i.EMOJI_FONT_FAMILY);e.GameInterfaceEventHandler=function(){var t=0;return function(e,r){if((0,u.isGameState)(e)){var n=e.canvas,a=e.context,h=e.world,p=e.previousUpdateTime;if("keyDown"!==r.type){if("tick"===r.type){var v=h.player;!function(e,r){var n=e.health/e.maxHealth;if(n!==t){var o=.01*(n-t),i=performance.now()-r,a=t+o*i,u=Math.abs(a-n);u>1||(t=u<.01?n:a)}}(v,p),v.inventory.draw(a,new c.Coordinates(n.width/2,n.height-32-16),new c.Coordinates(l,l)),(0,s.drawBar)(t,a,new c.Coordinates(n.width/2,n.height-l-32-8),new c.Coordinates(l*o.INVENTORY_SIZE,16),s.HEALTH_BAR_COLOR),d(v,n,a),a.save(),a.fillStyle="#eee",a.font=f,(0,i.drawText)(a,"❤ ".concat((0,i.formatNumber)(v.health)," / ").concat((0,i.formatNumber)(v.maxHealth),"  |  ")+"👊 ".concat((0,i.formatNumber)(v.actualDamage),"  |  ")+"🛡️ ".concat((0,i.formatNumber)(v.actualArmor),"  |  ")+"✨ ".concat((0,i.formatNumber)(v.xp)," / ").concat((0,i.formatNumber)(v.nextLevelCost),"  |  ")+"⬆️ ".concat((0,i.formatNumber)(v.level)),n.width/2,n.height-l-48-16-16,{centerWidth:!0}),a.restore()}}else{if("Escape"===r.event.code)return{state:"mainMenu",canvas:n,context:a,previousUpdateTime:p};if(e.state!==u.GameStateState.COMMON)return;if("Enter"===r.event.code)return void h.player.inventory.useSelectedItem(h);if("Backspace"===r.event.code)return void h.player.inventory.dropSelectedItem(h);var y=h.player.inventory.selectedItem,m=y;switch(r.event.code){case"Digit1":m=0;break;case"Digit2":m=1;break;case"Digit3":m=2;break;case"Digit4":m=3;break;case"Digit5":m=4;break;case"Digit6":m=5;break;case"Digit7":m=6;break;case"Digit8":m=7;break;case"Digit9":m=8;break;case"ArrowLeft":m=(o.INVENTORY_SIZE+y-1)%o.INVENTORY_SIZE;break;case"ArrowRight":m=(y+1)%o.INVENTORY_SIZE}h.player.inventory.selectedItem=m}}}};var h=function(t){switch(t){case a.EquipmentType.SWORD:return"👊";case a.EquipmentType.ARMOR:return"🛡️";default:return""}},d=function(t,e,r){var a,u,s=t.equipment.filter((function(t){return void 0!==t})),d=l*o.ITEM_SCALE_FACTOR,p=new c.Coordinates(d,d),v=16+d/2,y=e.height;try{for(var m=n(s),b=m.next();!b.done;b=m.next()){var x=b.value;y-=d/2+16,x.draw(r,new c.Coordinates(v,y),p),r.save(),0===x.equipmentBonus?r.fillStyle="#eee":x.equipmentBonus>0?r.fillStyle="#0bce00":r.fillStyle="#d00000",r.font=f,(0,i.drawText)(r,(0,i.formatNumber)(x.equipmentBonus,!0)+" "+h(x.equipmentType),v+d/2+16,y,{centerHeight:!0}),r.restore()}}catch(t){a={error:t}}finally{try{b&&!b.done&&(u=m.return)&&u.call(m)}finally{if(a)throw a.error}}}},4993:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GameWorldEventHandler=void 0;var o=r(1877),i=r(2267),a=r(909),u=n(r(7785));(0,i.loadTexture)(u.default),e.GameWorldEventHandler=function(t,e){if((0,o.isGameState)(t)){if(t.state===o.GameStateState.COMMON&&"keyDown"===e.type)switch(e.event.code){case"KeyW":t.world.movePlayer(new a.Coordinates(0,-1))&&(t.cameraOffset.y-=t.scale.y);break;case"KeyA":t.world.movePlayer(new a.Coordinates(-1,0))&&(t.cameraOffset.x-=t.scale.x);break;case"KeyS":t.world.movePlayer(new a.Coordinates(0,1))&&(t.cameraOffset.y+=t.scale.y);break;case"KeyD":t.world.movePlayer(new a.Coordinates(1,0))&&(t.cameraOffset.x+=t.scale.x)}if("tick"===e.type){s(t);var r=new a.Coordinates(~~(t.canvas.width/2+t.cameraOffset.x),~~(t.canvas.height/2+t.cameraOffset.y));c(t.context,new a.Coordinates(t.canvas.width,t.canvas.height),r,t.scale),t.world.updateDistance=t.updateDistance,t.world.draw(t.context,r,t.scale),t.state!==o.GameStateState.PLAYER_DIE&&l(t)}}};var s=function(t){var e=t.cameraOffset,r=t.previousUpdateTime,n=e.length()/4;if(!isFinite(n)||n<.5)return e.x=0,void(e.y=0);var o=performance.now()-r,i=Math.max(n,25),a=e.norm();Math.abs(e.x)<1?e.x=0:e.x-=a.x*i/o,Math.abs(e.y)<1?e.y=0:e.y-=a.y*i/o},c=function(t,e,r,n){for(var o=e.x,s=e.y,c=2+~~(o/n.x),l=2+~~(s/n.y),f=(n.x-r.x%n.x)%n.x,h=(n.y-r.y%n.y)%n.y,d=0;d<=c;++d)for(var p=0;p<=l;++p)(0,i.drawTexture)(u.default,t,new a.Coordinates(-f+d*n.x,-h+p*n.y),n)},l=function(t){var e=t.canvas,r=t.context,n=t.darknessRadius,o=r.createRadialGradient(e.width/2,e.height/2,n,e.width/2,e.height/2,Math.max(e.width,e.height)/2);o.addColorStop(0,"rgba(0, 0, 0, 0)"),o.addColorStop(1,"rgba(0, 0, 0, 0.9)"),r.fillStyle=o,r.fillRect(0,0,e.width,e.height)}},4569:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InitEventHandler=void 0,e.InitEventHandler=function(t,e){var r=t.canvas;if("load"===e.type||"resize"==e.type){var n=document.body.getBoundingClientRect();r.width=n.width,r.height=n.height}}},5815:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LevelUpEventHandler=void 0;var n=r(3380),o=r(1877);e.LevelUpEventHandler=function(){var t=void 0;return function(e,r){if((0,o.isGameState)(e))if("levelUp"!==r.type){if(void 0!==t&&"tick"===r.type){if(t.remainingTime-=performance.now()-e.previousUpdateTime,t.remainingTime<=0)return void(t=void 0);var i=e.canvas,a=e.context,u=e.world;a.save();var s=t.remainingTime/2e3;a.fillStyle="rgba(0, 0, 0, ".concat(.6*s,")"),a.fillRect(0,0,i.width,i.height),a.fillStyle="rgba(238, 238, 238, ".concat(s,")"),a.font="bold 42px ".concat(n.EMOJI_FONT_FAMILY),(0,n.drawText)(a,"✨ LEVEL UP ✨️\n\n"+"👊 +".concat((0,n.formatNumber)(u.player.actualDamage-t.event.previousDamage),"  |  ")+"🛡️ +".concat((0,n.formatNumber)(u.player.actualArmor-t.event.previousArmor)),i.width/2,i.height/2,{centerWidth:!0,centerHeight:!0}),a.restore()}}else t={remainingTime:2e3,event:r}}}},1716:function(t,e,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MainMenuEventHandler=void 0;var u=r(7969),s=r(909),c=r(5989),l=r(9133),f=r(9122),h=r(398),d=r(9514),p=r(3981),v=r(6926),y=r(9493),m=r(7615),b=r(422),x=r(3380),w=r(1877),_=r(8008),g=r(4204),O=r(5683),M=a(r(6315));e.MainMenuEventHandler=function(t,e,r){if("mainMenu"===t.state){if("keyDown"===e.type){var o=void 0;switch(e.event.code){case"Digit1":o=1;break;case"Digit2":o=2;break;case"Digit3":o=3;break;default:return}var i=n(n({},t),{state:w.GameStateState.COMMON,world:new u.GameWorld(r),darknessRadius:130,scale:new s.Coordinates(100,100),updateDistance:10,cameraOffset:new s.MutableCoordinates(0,0)});return 1===o?i.world=S(r):2===o?T(r).then((function(t){i.world=t})):E(r).then((function(t){i.world=t})),i}if("tick"===e.type){var a=t.canvas,c=t.context;c.save(),c.font="20px ".concat(x.DEFAULT_FONT_FAMILY),c.fillStyle="#eee",(0,x.drawText)(c,"Press button to start:\n\n1. Load stub world\n2. Load random world\n3. Load world from file",a.width/2,a.height/2,{centerWidth:!0,centerHeight:!0}),c.restore()}}};var S=function(t){var e=new u.GameWorld(t),r=new c.Wall;return r.coordinates=new s.Coordinates(-4,-3),r.matrix=[[!0,!0,!0,!0,!0,!0,!0,!0],[!0,!1,!1,!1,!1,!1,!1,!0],[!0,!1,!1,!0,!1,!1,!1,!0],[!0,!1,!1,!0,!1,!1,!1,!0],[!0,!1,!1,!0,!1,!1,!1,!0],[!0,!1,!0,!0,!0,!1,!1,!0],[!0,!1,!1,!1,!1,!1,!1,!0],[!0,!0,!0,!0,!0,!0,!0,!0]],e.objects.push(r),e.placeObject(new l.DroppedItem(new f.Sword,new s.Coordinates(1,1))),e.placeObject(new l.DroppedItem(new h.GoldenApple,new s.Coordinates(2,3))),e.placeObject(new O.Mimic(new h.GoldenApple,new s.Coordinates(2,2))),e.placeObject(new _.Robot(new s.Coordinates(-3,2))),e.placeObject(new g.Ghost(new s.Coordinates(0,3))),e.player.health=4.23,e},T=function(t){return o(void 0,void 0,void 0,(function(){var e,r;return i(this,(function(n){return e=new p.UniformItemGenerator([[(0,m.constGenerator)((function(){return new f.Sword})),2],[(0,m.constGenerator)((function(){return new h.GoldenApple})),1]]),r=new p.UniformMobGenerator([[new v.MagicalMobGenerator(e,{Mimic:3,Ghost:2,Wizard:2}),7],[new y.TechnoMobGenerator({Robot:2}),2]]),[2,(new d.GeneratorsWorldBuilder).random().eventBus(t).randomInstance((0,b.seededRandom)(""+performance.now())).maxDepth(5).maxItemsInRoom(3).maxMobsInRoom(2).boxSize(new s.Coordinates(6,5)).itemGenerator(e).mobGenerator(r).build()]}))}))},E=function(t){return o(void 0,void 0,void 0,(function(){return i(this,(function(e){return[2,(new d.GeneratorsWorldBuilder).fromFile().eventBus(t).filename(M.default).build()]}))}))}},7618:function(t,e,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.PlayerDieEventHandler=void 0;var o=r(1877),i=r(3380);e.PlayerDieEventHandler=function(t,e){if((0,o.isGameState)(t)){if("playerDie"===e.type)return n(n({},t),{state:o.GameStateState.PLAYER_DIE});if(t.state===o.GameStateState.PLAYER_DIE&&"tick"===e.type){var r=t.canvas,a=t.context;a.save(),a.fillStyle="rgba(0, 0, 0, 0.6)",a.fillRect(0,0,r.width,r.height),a.fillStyle="#d71919",a.font="bold 42px ".concat(i.EMOJI_FONT_FAMILY),(0,i.drawText)(a,"☠️ YOU DIED ☠️",r.width/2,r.height/2,{centerWidth:!0,centerHeight:!0}),a.restore()}}}},2238:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractMovable=void 0;var n=r(2267),o=function(){function t(t,e){void 0===e&&(e=!0),this.isPassable=e,this.texture=t}return t.prototype.draw=function(t,e,r){(0,n.drawTexture)(this.texture,t,e,r)},t.prototype.collides=function(t){return this.coordinates.equals(t)},t.prototype.needUpdate=function(t,e){return t.vectorTo(this.coordinates).length()<=e},t.prototype.moveTo=function(t,e){return e.moveObject(this,t)},t}();e.AbstractMovable=o},9133:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DroppedItem=void 0;var n=r(909),o=.5,i=function(){function t(t,e){this.isPassable=!0,this.coordinates=e,this.item=t}return t.prototype.onStep=function(t){t.player.inventory.pickItem(this.item)&&t.removeObject(this)},t.prototype.needUpdate=function(t,e){return t.vectorTo(this.coordinates).length()<=e},t.prototype.collides=function(t){return this.coordinates.equals(t)},t.prototype.draw=function(t,e,r){t.save(),t.fillStyle="rgba(0, 0, 0, 0.3)",t.beginPath(),t.ellipse(e.x,e.y+r.y*o/2,r.x*o/2,r.y*o/4,0,0,2*Math.PI),t.closePath(),t.fill(),t.restore(),this.item.draw(t,e,new n.Coordinates(r.x*o,r.y*o))},t}();e.DroppedItem=i},7969:function(t,e,r){"use strict";var n=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.GameWorld=void 0;var u=r(909),s=r(4463),c=r(5588),l=r(6474);e.GameWorld=function(){function t(t){this.objects=[],this.player=new s.Player,this.updateDistance=0,this._eventBus=t,this.objects.push(this.player)}return Object.defineProperty(t.prototype,"eventBus",{get:function(){return this._eventBus},enumerable:!1,configurable:!0}),t.prototype.placeObject=function(t){var e=this.objects.indexOf(this.player);-1!==e?this.objects.splice(e,0,t):console.error("Player is not in objects list")},t.prototype.removeObject=function(t){var e=this.objects.indexOf(t);return-1!==e&&(this.objects.splice(e,1),!0)},t.prototype.isObjectInWorld=function(t){return this.objects.includes(t)},t.prototype.movePlayer=function(t){var e,r,n,s,f=new u.Coordinates(this.player.coordinates.x+t.x,this.player.coordinates.y+t.y);if(this.checkCollisionWithObjects(f).length>0)return!1;this.player.coordinates=f;try{for(var h=a(i([],o(this.objects),!1)),d=h.next();!d.done;d=h.next()){var p=d.value;p.needUpdate(f,this.updateDistance)&&(0,l.isMovable)(p)&&p.onMove(this)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}var v=this.checkCollisionWithObjects(f,(function(t){return t.isPassable}),!1);try{for(var y=a(v),m=y.next();!m.done;m=y.next()){var b=m.value;(0,c.isTrigger)(b)&&b.onStep(this)}}catch(t){n={error:t}}finally{try{m&&!m.done&&(s=y.return)&&s.call(y)}finally{if(n)throw n.error}}return!0},t.prototype.moveObject=function(t,e,r){return void 0===r&&(r=!0),!(!t.coordinates.equals(e)&&(this.removeObject(t),r&&this.checkCollisionWithObjects(e).length>0||(t.coordinates=e,this.placeObject(t),0)))},t.prototype.hitPlayer=function(e){var r=t.calcDamage(e,this.player.actualArmor);if(r>=this.player.health)return this.player.health=0,void this.eventBus({type:"playerDie"});this.player.health-=r},t.prototype.givePlayerXp=function(t){this.player.xp+=t;var e=this.player.nextLevelCost;if(this.player.xp>=e){this.player.xp-=e;var r={damage:this.player.actualDamage,armor:this.player.actualArmor};++this.player.level,this.eventBus({type:"levelUp",previousDamage:r.damage,previousArmor:r.armor})}},t.prototype.draw=function(t,e,r){var n,o;try{for(var i=a(this.objects),s=i.next();!s.done;s=i.next()){var c=s.value;if(c.needUpdate(this.player.coordinates,this.updateDistance)){var l=this.player.coordinates.vectorTo(c.coordinates);c.draw(t,new u.Coordinates(e.x+l.x*r.x,e.y+l.y*r.y),r)}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},t.prototype.checkCollisionWithObjects=function(t,e,r){var n,o;void 0===e&&(e=function(t){return!t.isPassable}),void 0===r&&(r=!0);var i=[];try{for(var u=a(this.objects),s=u.next();!s.done;s=u.next()){var c=s.value;if(e(c)&&c.collides(t)&&(i.push(c),r))return i}}catch(t){n={error:t}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return i},t.prototype.isPlayerVisibleFrom=function(e,r){if(void 0===r&&(r=function(t){return!t.isPassable}),this.player.collides(e))return!0;var n=function(t){return t instanceof s.Player||r(t)},i=this.player.coordinates;if(i.equals(e.round()))return!0;var a,c,l=[new u.Coordinates(i.x+.5,i.y+.5),new u.Coordinates(i.x+.5,i.y-.5),new u.Coordinates(i.x-.5,i.y+.5),new u.Coordinates(i.x-.5,i.y-.5)].map((function(t){return e.vectorTo(t)})).map((function(t){return[t,t.atan2()]})),f=l.filter((function(t){var e=o(t,2);return e[0],e[1]<0})).length;if(f%2!=0)return console.error("Unexpected case",l,e),!1;l.sort((function(t,e){var r=o(t,2),n=(r[0],r[1]),i=o(e,2);return i[0],n-i[1]})),2===f&&l.every((function(t){var e=o(t,2),r=(e[0],e[1]);return Math.abs(r)>Math.PI/2}))?(a=l[2][0],c=l[1][0]):(a=l[0][0],c=l[3][0]);for(var h=t.IS_PLAYER_VISIBLE_FROM_RAYS_COUNT,d=0;d<=h;++d)if(this.rayTrace(e,new u.Coordinates((a.x*d+c.x*(h-d))/h,(a.y*d+c.y*(h-d))/h),n,!0,!0).includes(this.player))return!0;return!1},t.prototype.rayTrace=function(e,r,n,u,s){var c,l;void 0===n&&(n=function(t){return!t.isPassable}),void 0===u&&(u=!0),void 0===s&&(s=!0);var f=[];try{for(var h=a(t.rayTraceCells(e,r,s)),d=h.next();!d.done;d=h.next()){var p=d.value;if(f.push.apply(f,i([],o(this.checkCollisionWithObjects(p,n,u)),!1)),u&&f.length>0)return f}}catch(t){c={error:t}}finally{try{d&&!d.done&&(l=h.return)&&l.call(h)}finally{if(c)throw c.error}}return f},t.rayTraceCells=function(t,e,r){var o,i,a,s,c,l;return void 0===r&&(r=!1),n(this,(function(n){switch(n.label){case 0:o=e.length(),i=e.atan2(),a=t.round(),s=t,n.label=1;case 1:return t.vectorTo(s).length()<=o?[4,a]:[3,9];case 2:return n.sent(),c=void 0,c=e.x>=0&&e.y>=0?[[new u.Coordinates(a.x+1,a.y),new u.Coordinates(a.x+.5,s.y+e.y*(a.x+.5-s.x)/e.x)],[new u.Coordinates(a.x+1,a.y+1),new u.Coordinates(a.x+.5,a.y+.5)],[new u.Coordinates(a.x,a.y+1),new u.Coordinates(s.x+e.x*(a.y+.5-s.y)/e.y,a.y+.5)]]:e.x>=0&&e.y<0?[[new u.Coordinates(a.x,a.y-1),new u.Coordinates(s.x+e.x*(a.y-.5-s.y)/e.y,a.y-.5)],[new u.Coordinates(a.x+1,a.y-1),new u.Coordinates(a.x+.5,a.y-.5)],[new u.Coordinates(a.x+1,a.y),new u.Coordinates(a.x+.5,s.y+e.y*(a.x+.5-s.x)/e.x)]]:e.x<0&&e.y<0?[[new u.Coordinates(a.x-1,a.y),new u.Coordinates(a.x-.5,s.y+e.y*(a.x-.5-s.x)/e.x)],[new u.Coordinates(a.x-1,a.y-1),new u.Coordinates(a.x-.5,a.y-.5)],[new u.Coordinates(a.x,a.y-1),new u.Coordinates(s.x+e.x*(a.y-.5-s.y)/e.y,a.y-.5)]]:[[new u.Coordinates(a.x,a.y+1),new u.Coordinates(s.x+e.x*(a.y+.5-s.y)/e.y,a.y+.5)],[new u.Coordinates(a.x-1,a.y+1),new u.Coordinates(a.x-.5,a.y+.5)],[new u.Coordinates(a.x-1,a.y),new u.Coordinates(a.x-.5,s.y+e.y*(a.x-.5-s.x)/e.x)]],l=s.vectorTo(c[1][1]).atan2(),i<l?(a=c[0][0],s=c[0][1],[3,8]):[3,3];case 3:return i!==l?[3,7]:r?[4,c[0][0]]:[3,6];case 4:return n.sent(),[4,c[2][0]];case 5:n.sent(),n.label=6;case 6:return a=c[1][0],s=c[1][1],[3,8];case 7:a=c[2][0],s=c[2][1],n.label=8;case 8:return[3,1];case 9:return[2]}}))},t.calcDamage=function(t,e){return Math.max(0,t-e)},t.IS_PLAYER_VISIBLE_FROM_RAYS_COUNT=10,t}()},6947:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Inventory=e.ITEM_SCALE_FACTOR=e.INVENTORY_SIZE=void 0;var o=r(909),i=r(2267),a=r(9133),u=n(r(9718)),s=n(r(6063));e.INVENTORY_SIZE=9,e.ITEM_SCALE_FACTOR=.875;var c=68/64;(0,i.loadTexture)(u.default),(0,i.loadTexture)(s.default);var l=function(){function t(){this.items=new Array(e.INVENTORY_SIZE),this.selectedItem=0}return t.prototype.itemsCount=function(){return this.items.filter((function(t){return void 0!==t})).length},t.prototype.pickItem=function(t){for(var r=0;r<e.INVENTORY_SIZE;++r)if(void 0===this.items[r])return this.items[r]=t,!0;return!1},t.prototype.useSelectedItem=function(t){var e=this.items[this.selectedItem];void 0!==e&&(this.items[this.selectedItem]=e.useItem(t))},t.prototype.dropSelectedItem=function(t){var e=this.items[this.selectedItem];void 0!==e&&(t.placeObject(new a.DroppedItem(e,t.player.coordinates)),this.items[this.selectedItem]=void 0)},t.prototype.draw=function(t,r,n){var a;(0,i.drawTexture)(u.default,t,r,new o.Coordinates(n.x*e.INVENTORY_SIZE,n.y));var l=new o.Coordinates(r.x-(e.INVENTORY_SIZE-1)/2*n.x,r.y);(0,i.drawTexture)(s.default,t,new o.Coordinates(l.x+this.selectedItem*n.x,l.y),new o.Coordinates(n.x*c,n.y*c));for(var f=0;f<e.INVENTORY_SIZE;++f)null===(a=this.items[f])||void 0===a||a.draw(t,new o.Coordinates(l.x+f*n.x,l.y),new o.Coordinates(n.x*e.ITEM_SCALE_FACTOR,n.y*e.ITEM_SCALE_FACTOR))},t}();e.Inventory=l},6474:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isMovable=void 0,e.isMovable=function(t){return"onMove"in t}},4463:function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;var i=r(2267),a=r(1184),u=r(909),s=r(6947),c=o(r(5724));(0,i.loadTexture)(c.default);var l=function(){function t(){this.isPassable=!0,this.coordinates=u.Coordinates.ZERO,this.inventory=new s.Inventory,this.maxHealth=10,this.health=10,this.baseDamage=1,this.baseArmor=1,this.xp=0,this.level=1,this.baseLevelCost=1,this.equipment=new Array(a.EquipmentType.MAX_VALUE)}return Object.defineProperty(t.prototype,"actualDamage",{get:function(){var t,e,r=this.baseDamage*this.level;try{for(var o=n(this.equipment),i=o.next();!i.done;i=o.next()){var u=i.value;void 0!==u&&u.equipmentType===a.EquipmentType.SWORD&&(r+=u.equipmentBonus)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actualArmor",{get:function(){var t,e,r=this.baseArmor*this.level;try{for(var o=n(this.equipment),i=o.next();!i.done;i=o.next()){var u=i.value;void 0!==u&&u.equipmentType===a.EquipmentType.ARMOR&&(r+=u.equipmentBonus)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextLevelCost",{get:function(){return this.baseLevelCost*Math.pow(this.level,2)},enumerable:!1,configurable:!0}),t.prototype.healOn=function(t){if(this.health==this.maxHealth)return!1;var e=this.maxHealth*t;return this.health+=e,this.health=Math.min(this.health,this.maxHealth),!0},t.prototype.equipItem=function(t){var e=this.equipment[t.equipmentType];return this.equipment[t.equipmentType]=t,e},t.prototype.draw=function(t,e,r){(0,i.drawTexture)(c.default,t,e,r)},t.prototype.collides=function(t){return t.equals(this.coordinates)},t.prototype.needUpdate=function(){return!0},t}();e.Player=l},5588:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isTrigger=void 0,e.isTrigger=function(t){return"onStep"in t}},5989:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Wall=void 0;var o=r(2267),i=r(909),a=n(r(8817));(0,o.loadTexture)(a.default);var u=function(){function t(){this.isPassable=!1,this.coordinates=i.Coordinates.ZERO,this.matrix=[]}return t.prototype.draw=function(t,e,r){for(var n=0;n<this.matrix.length;++n)for(var u=this.matrix[n],s=0;s<u.length;++s)u[s]&&(0,o.drawTexture)(a.default,t,new i.Coordinates(e.x+r.x*s,e.y+r.y*n-.25*r.y),new i.Coordinates(r.x,1.5*r.y))},t.prototype.collides=function(t){var e;return null!==(e=this.getMatrixValueByCoordinates(t))&&void 0!==e&&e},t.prototype.needUpdate=function(t,e){var r,n;if(void 0!==this.getMatrixValueByCoordinates(t))return!0;var o=null!==(n=null===(r=this.matrix[0])||void 0===r?void 0:r.length)&&void 0!==n?n:0,a=this.matrix.length;return(t.x<this.coordinates.x?t.y<this.coordinates.y?t.vectorTo(this.coordinates).length():t.y<this.coordinates.y+a?this.coordinates.x-t.x:t.vectorTo(new i.Coordinates(this.coordinates.x,this.coordinates.y+a)).length():t.x<this.coordinates.x+o?Math.min(Math.abs(this.coordinates.y-t.y),Math.abs(this.coordinates.y+a-t.y)):t.y<this.coordinates.y?t.vectorTo(new i.Coordinates(this.coordinates.x+o,this.coordinates.y)).length():t.y<this.coordinates.y+a?this.coordinates.x+o-t.x:t.vectorTo(new i.Coordinates(this.coordinates.x+o,this.coordinates.y+a)).length())<e},t.prototype.getMatrixValueByCoordinates=function(t){var e=t.y-this.coordinates.y,r=t.x-this.coordinates.x;if(e>=0&&e<this.matrix.length){var n=this.matrix[e];if(r>=0&&r<n.length)return n[r]}},t}();e.Wall=u},1715:function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.AggressiveBehaviourModel=void 0;var i=r(8178),a=function(){function t(t){void 0===t&&(t=new i.PassiveBehaviourModel),this.noPlayerBehaviour=t}return t.prototype.onMove=function(e,r){var o,i;if(!e.coordinates.equals(r.player.coordinates)){if(!r.isPlayerVisibleFrom(e.coordinates))return this.noPlayerBehaviour.onMove(e,r);var a=t.findNearestCellToPlayer(e.coordinates,r.player.coordinates);try{for(var u=n(a),s=u.next();!s.done;s=u.next()){var c=s.value;if(e.moveTo(c,r))return}}catch(t){o={error:t}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}}},t.prototype.clone=function(){return new t(this.noPlayerBehaviour)},t.findNearestCellToPlayer=function(t,e){return t.adjacent().map((function(t){return[t,t.vectorTo(e).length()]})).sort((function(t,e){var r=o(t,2),n=(r[0],r[1]),i=o(e,2);return i[0],n-i[1]})).map((function(t){var e=o(t,2),r=e[0];return e[1],r}))},t}();e.AggressiveBehaviourModel=a},5943:function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.AvoidWallsBehaviourModel=void 0;var i=o(r(5908)),a=r(8178),u=r(1183),s=function(){function t(t){void 0===t&&(t=new a.PassiveBehaviourModel),this.noWallsBehaviour=t}return t.prototype.onMove=function(t,e){var r,o;if(0===e.checkCollisionWithObjects(t.coordinates).length)return this.noWallsBehaviour.onMove(t,e);var a=(0,u.shuffleInplace)(t.coordinates.adjacent(),i.default);try{for(var s=n(a),c=s.next();!c.done;c=s.next()){var l=c.value;if(t.moveTo(l,e))return}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}},t.prototype.clone=function(){return new t(this.noWallsBehaviour)},t}();e.AvoidWallsBehaviourModel=s},1997:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.BehaviourMovable=void 0;var i=function(t){function e(e,r,n){void 0===n&&(n=!0);var o=t.call(this,r,n)||this;return o.coordinates=e,o}return o(e,t),e.prototype.onMove=function(t){this.behaviourModel(t).onMove(this,t)},e}(r(2238).AbstractMovable);e.BehaviourMovable=i},1955:function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.ConfusedBehaviourModel=void 0;var i=o(r(5908)),a=r(1183),u=function(){function t(){}return t.prototype.onMove=function(t,e){var r,o,u=(0,a.shuffleInplace)(t.coordinates.adjacent(),i.default);try{for(var s=n(u),c=s.next();!c.done;c=s.next()){var l=c.value;if(t.moveTo(l,e))return}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}},t.prototype.clone=function(){return new t},t}();e.ConfusedBehaviourModel=u},409:function(t,e,r){"use strict";var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a};Object.defineProperty(e,"__esModule",{value:!0}),e.CowardlyBehaviourModel=void 0;var i=r(8178),a=function(){function t(t){void 0===t&&(t=new i.PassiveBehaviourModel),this.noPlayerBehaviour=t}return t.prototype.onMove=function(e,r){var o,i;if(!r.isPlayerVisibleFrom(e.coordinates))return this.noPlayerBehaviour.onMove(e,r);var a=t.findFarthestCellFromPlayer(e.coordinates,r.player.coordinates);try{for(var u=n(a),s=u.next();!s.done;s=u.next()){var c=s.value;if(e.moveTo(c,r))return}}catch(t){o={error:t}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}},t.prototype.clone=function(){return new t(this.noPlayerBehaviour)},t.findFarthestCellFromPlayer=function(t,e){return t.adjacent().map((function(t){return[t,t.vectorTo(e).length()]})).sort((function(t,e){var r=o(t,2),n=(r[0],r[1]),i=o(e,2);return i[0],i[1]-n})).map((function(t){var e=o(t,2),r=e[0];return e[1],r}))},t}();e.CowardlyBehaviourModel=a},8178:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PassiveBehaviourModel=void 0;var r=function(){function t(){}return t.prototype.onMove=function(){},t.prototype.clone=function(){return new t},t}();e.PassiveBehaviourModel=r},7967:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleBehaviourMovable=void 0;var i=function(t){function e(e,r,n){return void 0===n&&(n=!0),t.call(this,e,r,n)||this}return o(e,t),e.prototype.behaviourModel=function(){return this.actualBehaviourModel},e}(r(1997).BehaviourMovable);e.SimpleBehaviourMovable=i},2964:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TemporalBehaviourModel=void 0;var r=function(){function t(t,e,r){this.moves=t,this.behaviour=e,this.oldBehaviour=r}return t.prototype.onMove=function(t,e){if(this.moves<=0)return t.actualBehaviourModel=this.oldBehaviour,void this.oldBehaviour.onMove(t,e);this.behaviour.onMove(t,e),--this.moves},t.prototype.clone=function(){return new t(this.moves,this.behaviour,this.oldBehaviour)},t.decorate=function(e,r,n){e.actualBehaviourModel=new t(r,n,e.actualBehaviourModel)},t}();e.TemporalBehaviourModel=r},9514:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GeneratorRandomWorldBuilder=e.GeneratorsWorldBuilder=void 0;var a=i(r(5908)),u=r(4808),s=r(7945),c=r(909),l=function(){function t(){}return t.prototype.fromFile=function(){return new h},t.prototype.random=function(){return new f},t}();e.GeneratorsWorldBuilder=l;var f=function(){function t(){this._eventBus=void 0,this._random=a.default,this._maxDepth=3,this._maxItemsInRoom=2,this._maxMobsInRoom=2,this._boxSize=new c.Coordinates(6,5),this._itemGenerator=void 0,this._mobGenerator=void 0}return t.prototype.eventBus=function(t){return this._eventBus=t,this},t.prototype.randomInstance=function(t){return this._random=t,this},t.prototype.maxDepth=function(t){return this._maxDepth=t,this},t.prototype.maxItemsInRoom=function(t){return this._maxItemsInRoom=t,this},t.prototype.maxMobsInRoom=function(t){return this._maxMobsInRoom=t,this},t.prototype.boxSize=function(t){return this._boxSize=t,this},t.prototype.itemGenerator=function(t){return this._itemGenerator=t,this},t.prototype.mobGenerator=function(t){return this._mobGenerator=t,this},t.prototype.build=function(){if(void 0===this._eventBus)throw new Error("event bus isn't set");if(void 0===this._itemGenerator)throw new Error("item generator isn't set");if(void 0===this._mobGenerator)throw new Error("mob generator isn't set");return new u.BoxedWorldGenerator(this._eventBus,this._maxDepth,this._maxItemsInRoom,this._maxMobsInRoom,this._boxSize,this._itemGenerator,this._mobGenerator).generate(this._random)},t}();e.GeneratorRandomWorldBuilder=f;var h=function(){function t(){this._eventBus=void 0,this._content=void 0,this._filename=void 0}return t.prototype.eventBus=function(t){return this._eventBus=t,this},t.prototype.filename=function(t){return this._filename=t,this._content=void 0,this},t.prototype.content=function(t){return this._filename=void 0,this._content=t,this},t.prototype.build=function(){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:if(void 0===this._eventBus)throw new Error("event bus isn't set");return void 0===this._filename?[3,2]:[4,s.FileWorldGenerator.loadFile(this._filename,this._eventBus)];case 1:return[2,t.sent().generate()];case 2:if(void 0!==this._content)return[2,new s.FileWorldGenerator(this._content,this._eventBus).generate()];throw new Error("neither filename nor content are set")}}))}))},t}()},672:function(t,e){"use strict";var r=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractGenerator=void 0;var o=function(){function t(t,e){this.generator=t,this.fn=e}return t.prototype.generate=function(t){return r(this,void 0,void 0,(function(){var e;return n(this,(function(r){switch(r.label){case 0:return e=this.fn,[4,this.generator.generate(t)];case 1:return[2,e.apply(this,[r.sent(),t])]}}))}))},t.prototype.map=function(e){return new t(this,e)},t}(),i=function(){function t(){}return t.prototype.map=function(t){return new o(this,t)},t}();e.AbstractGenerator=i},4808:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},u=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},c=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.BoxedWorldGenerator=void 0;var l=r(672),f=r(3775),h=r(909),d=r(9133),p=r(1183),v=r(7252),y=r(7969),m=r(5989),b=function(t,e){this.coordinates=t,this.objects=e},x=function(t){function e(e,r,n,o,i,a,u){var s=t.call(this)||this;return s.eventBus=e,s.maxDepth=r,s.maxItemsInRoom=n,s.maxMobsInRoom=o,s.boxSize=i,s.itemGenerator=a,s.mobGenerator=u,s}return o(e,t),e.prototype.generate=function(t){return i(this,void 0,void 0,(function(){var e,r,n;return a(this,(function(o){switch(o.label){case 0:return[4,this.generateBoxes(t)];case 1:return e=u.apply(void 0,[o.sent(),2]),r=e[0],n=e[1],[2,this.buildWorld(r,n)]}}))}))},e.prototype.buildWorld=function(t,e){var r,n,o,i,a,l,f,d,p=this,b=new h.Coordinates(Math.min.apply(Math,s([],u(t.map((function(t){return t.coordinates.x}))),!1)),Math.min.apply(Math,s([],u(t.map((function(t){return t.coordinates.y}))),!1))),x=new h.Coordinates(Math.max.apply(Math,s([],u(t.map((function(t){return t.coordinates.x}))),!1))-b.x+1,Math.max.apply(Math,s([],u(t.map((function(t){return t.coordinates.y}))),!1))-b.y+1),_=new m.Wall;_.coordinates=new h.Coordinates(b.x*(this.boxSize.x+1),b.y*(this.boxSize.y+1)),_.matrix=(0,v.range)(x.y*(this.boxSize.y+1)+1).map((function(t){return(0,v.range)(x.x*(p.boxSize.x+1)+1).map((function(t){return!1}))}));try{for(var g=c(t),O=g.next();!O.done;O=g.next()){for(var M=((D=O.value).coordinates.x-b.x)*(this.boxSize.x+1),S=(D.coordinates.y-b.y)*(this.boxSize.y+1),T=0;T<=this.boxSize.x+1;++T)_.matrix[S][M+T]=!0,_.matrix[S+this.boxSize.y+1][M+T]=!0;for(var E=0;E<=this.boxSize.y+1;++E)_.matrix[S+E][M]=!0,_.matrix[S+E][M+this.boxSize.x+1]=!0}}catch(t){r={error:t}}finally{try{O&&!O.done&&(n=g.return)&&n.call(g)}finally{if(r)throw r.error}}var j=function(t){var r,n,o=t.coordinates,i=[new h.Coordinates(o.x+1,o.y),new h.Coordinates(o.x,o.y+1)].filter((function(t){return e.has(w(o,t))}));try{for(var a=(r=void 0,c(i)),u=a.next();!u.done;u=a.next()){var s=u.value;if(s.x===o.x){var l=(o.x-b.x)*(C.boxSize.x+1)+~~(C.boxSize.x/2)+1,f=(o.y-b.y+1)*(C.boxSize.y+1);_.matrix[f][l]=!1,C.boxSize.x%2==0&&(_.matrix[f][l-1]=!1)}s.y===o.y&&(l=(o.x-b.x+1)*(C.boxSize.x+1),f=(o.y-b.y)*(C.boxSize.y+1)+~~(C.boxSize.y/2)+1,_.matrix[f][l]=!1,C.boxSize.y%2==0&&(_.matrix[f-1][l]=!1))}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},C=this;try{for(var P=c(t),I=P.next();!I.done;I=P.next())j(D=I.value)}catch(t){o={error:t}}finally{try{I&&!I.done&&(i=P.return)&&i.call(P)}finally{if(o)throw o.error}}var A=new y.GameWorld(this.eventBus);A.objects.push(_);try{for(var B=c(t),G=B.next();!G.done;G=B.next()){var D;T=(D=G.value).coordinates.x*(this.boxSize.x+1)+1,E=D.coordinates.y*(this.boxSize.y+1)+1;try{for(var R=(f=void 0,c(D.objects)),k=R.next();!k.done;k=R.next()){var W=k.value;W.coordinates=new h.Coordinates(W.coordinates.x+T,W.coordinates.y+E),A.placeObject(W)}}catch(t){f={error:t}}finally{try{k&&!k.done&&(d=R.return)&&d.call(R)}finally{if(f)throw f.error}}}}catch(t){a={error:t}}finally{try{G&&!G.done&&(l=B.return)&&l.call(B)}finally{if(a)throw a.error}}return A.player.coordinates=new h.Coordinates(1+~~(this.boxSize.x/2),1+~~(this.boxSize.y/2)),A},e.prototype.generateBoxes=function(t){return i(this,void 0,void 0,(function(){var e,r,n,o,l,y,m,x,_,g,O,M,S,T,E,j,C,P,I,A,B,G,D,R,k,W,N=this;return a(this,(function(H){switch(H.label){case 0:e=new Set,r=[],n=[h.Coordinates.ZERO],o=new Map,l=[[0,0]],y=new Set,o.set(h.Coordinates.ZERO.toString(),0),y.add(0),m=t.uniformInt(0,4),x=1,H.label=1;case 1:return l.length>0?(_=u(l.pop(),2),g=_[0],O=_[1],y.has(g)?(y.delete(g),M=n[g],S=t.integer(0,this.maxItemsInRoom),T=t.integer(0,this.maxMobsInRoom),E=(0,p.sample)(S+T,(0,v.range)(this.boxSize.x).flatMap((function(t){return(0,v.range)(N.boxSize.y).map((function(e){return new h.Coordinates(t,e)}))})),t),[4,Promise.all(E.splice(0,S).map((function(e){return i(N,void 0,void 0,(function(){var r;return a(this,(function(n){switch(n.label){case 0:return r=d.DroppedItem.bind,[4,this.itemGenerator.generate(t)];case 1:return[2,new(r.apply(d.DroppedItem,[void 0,n.sent(),e]))]}}))}))})))]):[3,1]):[3,5];case 2:return j=H.sent(),[4,Promise.all(E.splice(0,T).map((function(e){return i(N,void 0,void 0,(function(){var r;return a(this,(function(n){switch(n.label){case 0:return[4,this.mobGenerator.generate(t)];case 1:return(r=n.sent()).coordinates=e,[2,r]}}))}))})))];case 3:if(C=H.sent(),r[g]=new b(M,s(s([],u(j),!1),u(C),!1)),O<this.maxDepth){P=m(),I=(0,p.sample)(P,M.adjacent(),t);try{for(k=void 0,A=c(I),B=A.next();!B.done;B=A.next())G=B.value,e.add(w(M,G)),D=G.toString(),o.has(D)||(R=x++,n[R]=G,o.set(D,R),y.add(R),l.unshift([R,O+1]))}catch(t){k={error:t}}finally{try{B&&!B.done&&(W=A.return)&&W.call(A)}finally{if(k)throw k.error}}}return[4,(0,f.delayPromise)()];case 4:return H.sent(),[3,1];case 5:return[2,[r,e]]}}))}))},e}(l.AbstractGenerator);e.BoxedWorldGenerator=x;var w=function(t,e){var r,n=t.toString(),o=e.toString();return n>o&&(n=(r=u([o,n],2))[0],o=r[1]),"".concat(n,":").concat(o)}},7945:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}},u=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.FileWorldGenerator=void 0;var c=r(398),l=r(672),f=r(909),h=r(9133),d=r(9122),p=r(7969),v=r(5989);e.FileWorldGenerator=function(t){function e(e,r){var n=t.call(this)||this;return n.objects=[],n.playerPosition=f.Coordinates.ZERO,n.eventBus=r,n.parseFile(e),n}return o(e,t),e.prototype.generate=function(){return i(this,void 0,void 0,(function(){var t;return a(this,(function(e){return(t=new p.GameWorld(this.eventBus)).player.coordinates=this.playerPosition,this.objects.forEach((function(e){return t.placeObject(e)})),t.objects.push(this.wall),[2,t]}))}))},e.prototype.parseFile=function(t){var e,r=(e=u(this.parseWalls(t),2))[0],n=e[1];this.parseHoleFillers(n,r)},e.prototype.parseWalls=function(t){var r,n,o,i=(r=u(e.parseToken(t),2))[0],a=r[1],s=(n=u(i.split(e.WHITESPACE).map((function(t){return+t})),2))[0],c=n[1];if(void 0===s||void 0===c)throw new Error("first line must contain width and height");this.wall=new v.Wall;for(var l=a,h=[],d=0;d<c;++d){var p=(o=u(e.parseToken(l),2))[0];l=o[1];var y=p.split(e.WHITESPACE);if(y.length!==s)throw new Error("amount of values on line ".concat(d," isn't match width ").concat(s));for(var m=[],b=0;b<y.length;b++)"W"!==y[b]?(m.push(!1),"."!==y[b]&&(h[+y[b]]=new f.Coordinates(b,d))):m.push(!0);this.wall.matrix.push(m)}return[h,l]},e.prototype.parseHoleFillers=function(t,e){var r,n,o=t.split("\n").map((function(t){return t.trim()}));try{for(var i=s(o),a=i.next();!a.done;a=i.next()){var u=a.value;this.parseHoleFiller(u,e)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.parseHoleFiller=function(t,r){var n,o,i=(n=u(e.parseToken(t,"."),2))[0],a=n[1];if(""!==i){var s=+i,c=r[s];if(void 0===c)throw new Error("hole ".concat(s," is not on field"));var l=(o=u(e.parseToken(a.trimStart(),e.WHITESPACE),2))[0],f=o[1];switch(l){case"Player":this.playerPosition=c;break;case"Item":this.objects.push(new h.DroppedItem(e.parseItem(f),c));break;default:console.warn('Ignore unknown hole filler "'.concat(l,'"'))}}},e.parseItem=function(t){switch(t){case"Sword":return new d.Sword;case"GoldenApple":return new c.GoldenApple;default:throw new Error('unknown item "'.concat(t,'"'))}},e.parseToken=function(t,e){var r,n;void 0===e&&(e="\n");var o="string"==typeof e?t.indexOf(e):null!==(n=null===(r=t.match(e))||void 0===r?void 0:r.index)&&void 0!==n?n:-1;return-1===o?[t.trim(),""]:[t.substring(0,o).trim(),t.substring(o+1)]},e.loadFile=function(t,r){return i(this,void 0,void 0,(function(){var n,o;return a(this,(function(i){switch(i.label){case 0:return[4,fetch(t)];case 1:return n=i.sent(),o=e.bind,[4,n.text()];case 2:return[2,new(o.apply(e,[void 0,i.sent(),r]))]}}))}))},e.WHITESPACE=/\s+/,e}(l.AbstractGenerator)},6926:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MagicalMobGenerator=void 0;var i=r(3981),a=r(909),u=r(7615),s=r(5033),c=r(4204),l=r(5683),f=function(t){function e(e,r){return t.call(this,[[(0,u.constGenerator)((function(){return new c.Ghost(a.Coordinates.ZERO)})),r.Ghost],[(0,u.constGenerator)((function(){return new s.Wizard(a.Coordinates.ZERO)})),r.Wizard],[e.map((function(t){return new l.Mimic(t,a.Coordinates.ZERO)})),r.Mimic]])||this}return o(e,t),e}(i.UniformMobGenerator);e.MagicalMobGenerator=f},9493:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TechnoMobGenerator=void 0;var i=r(3981),a=r(909),u=r(7615),s=r(8008),c=function(t){function e(e){return t.call(this,[[(0,u.constGenerator)((function(){return new s.Robot(a.Coordinates.ZERO)})),e.Robot]])||this}return o(e,t),e}(i.UniformMobGenerator);e.TechnoMobGenerator=c},3981:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},u=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.UniformMobGenerator=e.UniformItemGenerator=e.UniformGenerator=void 0;var s=function(t){function e(e){var r=t.call(this)||this;return r.objects=a([],i(e),!1),r.sumProbability=e.map((function(t){var e=i(t,2);return e[0],e[1]})).reduce((function(t,e){return t+e}),0),r}return o(e,t),e.prototype.generate=function(t){var e,r,n=t.uniform(0,this.sumProbability)();try{for(var o=u(this.objects),a=o.next();!a.done;a=o.next()){var s=i(a.value,2),c=s[0],l=s[1];if(n<l)return c.generate(t);n-=l}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}throw new Error("no generators provided")},e}(r(672).AbstractGenerator);e.UniformGenerator=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(s);e.UniformItemGenerator=c;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(s);e.UniformMobGenerator=l},7615:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.constGenerator=void 0;var u=function(t){function e(e){var r=t.call(this)||this;return r.fn=e,r}return o(e,t),e.prototype.generate=function(){return i(this,void 0,void 0,(function(){return a(this,(function(t){return[2,this.fn()]}))}))},e}(r(672).AbstractGenerator);e.constGenerator=function(t){return new u(t)}},9003:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractEquipment=void 0;var i=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.equipmentType=r,o.equipmentBonus=n,o}return o(e,t),e.prototype.useItem=function(t){return t.player.equipItem(this)},e}(r(5250).TexturedItem);e.AbstractEquipment=i},1184:(t,e)=>{"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.EquipmentType=void 0,(r=e.EquipmentType||(e.EquipmentType={}))[r.SWORD=0]="SWORD",r[r.ARMOR=1]="ARMOR",r[r.MAX_VALUE=2]="MAX_VALUE"},398:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.GoldenApple=void 0;var a=r(2267),u=r(5250),s=i(r(168));(0,a.loadTexture)(s.default);var c=function(t){function e(){return t.call(this,s.default)||this}return o(e,t),e.prototype.useItem=function(t){if(!t.player.healOn(.2))return this},e}(u.TexturedItem);e.GoldenApple=c},9122:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Sword=void 0;var a=r(2267),u=r(9003),s=r(1184),c=i(r(4365));(0,a.loadTexture)(c.default);var l=function(t){function e(){return t.call(this,c.default,s.EquipmentType.SWORD,5)||this}return o(e,t),e}(u.AbstractEquipment);e.Sword=l},5250:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TexturedItem=void 0;var n=r(2267),o=function(){function t(t){this.texture=t}return t.prototype.draw=function(t,e,r){(0,n.drawTexture)(this.texture,t,e,r)},t}();e.TexturedItem=o},9963:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractMob=void 0;var i=r(7967),a=r(2964),u=r(1955),s=r(4945),c=r(909),l=r(7969),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.draw=function(e,r,n){t.prototype.draw.call(this,e,r,n),this.health<this.maxHealth&&(0,s.drawBar)(this.health/this.maxHealth,e,new c.Coordinates(r.x,r.y-.4*n.y),new c.Coordinates(.8*n.x,.1*n.y),s.HEALTH_BAR_COLOR)},e.prototype.onStep=function(t){var e=t.player,r=l.GameWorld.calcDamage(e.actualDamage,this.armor);this.hit(r,t),a.TemporalBehaviourModel.decorate(this,r,new u.ConfusedBehaviourModel),t.hitPlayer(this.damage)},e.prototype.hit=function(t,e){t>=this.health&&(e.givePlayerXp(this.experience),e.removeObject(this)),this.health-=t},e}(i.SimpleBehaviourMovable);e.AbstractMob=f},4204:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Ghost=void 0;var a=r(5943),u=r(409),s=r(2267),c=r(9963),l=i(r(4787));(0,s.loadTexture)(l.default);var f=function(t){function e(e){var r=t.call(this,e,l.default)||this;return r.actualBehaviourModel=new u.CowardlyBehaviourModel(new a.AvoidWallsBehaviourModel),r.health=3,r.maxHealth=3,r.damage=1,r.armor=0,r.experience=10,r.inWall=!1,r}return o(e,t),e.prototype.draw=function(e,r,n){this.inWall?(e.save(),e.globalAlpha=.6,t.prototype.draw.call(this,e,r,n),e.restore()):t.prototype.draw.call(this,e,r,n)},e.prototype.moveTo=function(t,e){var r=e.moveObject(this,t,!1),n=e.checkCollisionWithObjects(this.coordinates);return this.inWall=n.length>0,this.inWall&&(e.removeObject(this),e.objects.push(this)),r},e}(c.AbstractMob);e.Ghost=f},5683:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Mimic=void 0;var i=r(8178),a=r(2267),u=r(9133),s=function(t){function e(e,r){var n=t.call(this,r,a.NO_TEXTURE)||this;return n.actualBehaviourModel=new i.PassiveBehaviourModel,n.health=5,n.maxHealth=5,n.damage=2,n.armor=1,n.experience=1,n._item=e,n.droppedItem=new u.DroppedItem(e,n.coordinates),n}return o(e,t),Object.defineProperty(e.prototype,"item",{get:function(){return this._item},set:function(t){this._item=t,this.droppedItem=new u.DroppedItem(t,this.coordinates)},enumerable:!1,configurable:!0}),e.prototype.draw=function(e,r,n){this.droppedItem.coordinates=this.coordinates,this.droppedItem.draw(e,r,n),t.prototype.draw.call(this,e,r,n)},e}(r(9963).AbstractMob);e.Mimic=s},8008:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Robot=void 0;var a=r(1715),u=r(2267),s=r(9963),c=i(r(2655));(0,u.loadTexture)(c.default);var l=function(t){function e(e){var r=t.call(this,e,c.default)||this;return r.actualBehaviourModel=new a.AggressiveBehaviourModel,r.health=10,r.maxHealth=10,r.damage=5,r.armor=2,r.experience=10,r}return o(e,t),e}(s.AbstractMob);e.Robot=l},5033:function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Wizard=void 0;var u=a(r(5908)),s=r(1715),c=r(2267),l=r(1183),f=r(9963),h=a(r(6776));(0,c.loadTexture)(h.default);var d=function(t){function e(e){var r=t.call(this,e,h.default)||this;return r.actualBehaviourModel=new s.AggressiveBehaviourModel,r.health=10,r.maxHealth=10,r.damage=3,r.armor=1,r.experience=3,r}return o(e,t),e.prototype.clone=function(){var t=new e(this.coordinates);return t.actualBehaviourModel=this.actualBehaviourModel.clone(),t.health=this.health,t},e.prototype.hit=function(e,r){t.prototype.hit.call(this,e,r);var n=1-this.health/this.maxHealth;r.isObjectInWorld(this)&&u.default.uniform()()<n&&this.makeClone(r)},e.prototype.makeClone=function(t){var e,r,n=(0,l.shuffleInplace)(this.coordinates.adjacent(),u.default);try{for(var o=i(n),a=o.next();!a.done;a=o.next()){var s=a.value;if(0===t.checkCollisionWithObjects(s).length){var c=this.clone();return c.coordinates=s,void t.placeObject(c)}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},e}(f.AbstractMob);e.Wizard=d},1877:(t,e)=>{"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.isGameState=e.GameStateState=void 0,function(t){t.COMMON="game",t.PLAYER_DIE="playerDie"}(r=e.GameStateState||(e.GameStateState={})),e.isGameState=function(t){return Object.values(r).includes(t.state)}},909:function(t,e){"use strict";var r,n=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.MutableCoordinates=e.Coordinates=void 0;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(e.Coordinates=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.norm=function(){var e=this.length();return new t(this.x/e,this.y/e)},t.prototype.vectorTo=function(e){return new t(e.x-this.x,e.y-this.y)},t.prototype.atan2=function(){return Math.atan2(this.y,this.x)},t.prototype.round=function(){return new t(Math.round(this.x),Math.round(this.y))},t.prototype.adjacent=function(){return[new t(this.x+1,this.y),new t(this.x-1,this.y),new t(this.x,this.y+1),new t(this.x,this.y-1)]},t.prototype.equals=function(t){return this.x===t.x&&this.y==t.y},t.prototype.toString=function(){return"(".concat(this.x,", ").concat(this.y,")")},t.ZERO=new t(0,0),t}());e.MutableCoordinates=o},3775:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.delayPromise=void 0,e.delayPromise=function(t){return void 0===t&&(t=0),new Promise((function(e){return setTimeout(e,t)}))}},4945:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.drawBar=e.HEALTH_BAR_COLOR=void 0,e.HEALTH_BAR_COLOR="#e74236",e.drawBar=function(t,e,r,n,o,i){var a=void 0===i?{}:i,u=a.backgroundColor,s=void 0===u?"#ccc":u,c=a.borderColor,l=void 0===c?"#000":c,f=a.borderWidth,h=void 0===f?3:f;e.save(),e.fillStyle=s,e.fillRect(r.x-n.x/2,r.y-n.y/2,n.x,n.y),e.beginPath(),e.rect(r.x-n.x/2,r.y-n.y/2,n.x,n.y),e.clip(),e.fillStyle=o,e.fillRect(r.x-n.x/2,r.y-n.y/2,n.x*t,n.y);var d=e.createLinearGradient(0,r.y-n.y/2,0,r.y+n.y/2);d.addColorStop(0,"rgba(0, 0, 0, 0)"),d.addColorStop(1,"rgba(0, 0, 0, 0.6)"),e.fillStyle=d,e.fillRect(r.x-n.x/2,r.y-n.y/2,n.x,n.y),e.strokeStyle=l,e.lineWidth=h,e.strokeRect(r.x-n.x/2,r.y-n.y/2,n.x,n.y),e.restore()}},3380:function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},i=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(e,"__esModule",{value:!0}),e.formatNumber=e.measureText=e.drawText=e.DEFAULT_LINE_GAP=e.EMOJI_FONT_FAMILY=e.DEFAULT_FONT_FAMILY=void 0;var a=r(909);e.DEFAULT_FONT_FAMILY="Roboto, sans-serif",e.EMOJI_FONT_FAMILY='Roboto, "Noto Colr Emoji Glyf", sans-serif',e.DEFAULT_LINE_GAP=5,e.drawText=function(t,r,a,u,s){var c,l,f=void 0===s?{}:s,h=f.lineGap,d=void 0===h?e.DEFAULT_LINE_GAP:h,p=f.centerWidth,v=void 0!==p&&p,y=f.centerHeight,m=void 0!==y&&y,b=r.split("\n"),x=Math.max.apply(Math,o([],n(b.map((function(e){return t.measureText(e)})).map((function(t){return t.actualBoundingBoxAscent+t.actualBoundingBoxDescent}))),!1));m&&(u-=((x+d)*b.length-d)/2);try{for(var w=i(b),_=w.next();!_.done;_=w.next()){var g=_.value,O=t.measureText(g);u+=x-O.actualBoundingBoxDescent,v?t.fillText(g,a-O.width/2,u):t.fillText(g,a,u),u+=O.actualBoundingBoxDescent+d}}catch(t){c={error:t}}finally{try{_&&!_.done&&(l=w.return)&&l.call(w)}finally{if(c)throw c.error}}},e.measureText=function(t,r,i){var u=(void 0===i?{}:i).lineGap,s=void 0===u?e.DEFAULT_LINE_GAP:u,c=r.split("\n").map((function(e){return t.measureText(e)})),l=Math.max.apply(Math,o([],n(c.map((function(t){return t.actualBoundingBoxAscent+t.actualBoundingBoxDescent}))),!1)),f=Math.max.apply(Math,o([],n(c.map((function(t){return t.width}))),!1)),h=(l+s)*c.length-s;return new a.Coordinates(f,h)},e.formatNumber=function(t,e){void 0===e&&(e=!1);var r=t.toLocaleString("en-US",{maximumFractionDigits:2});return e&&t>=0?"+"+r:r}},2267:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.drawTexture=e.loadTexture=e.NO_TEXTURE=void 0,e.NO_TEXTURE=Symbol("no texture");var r=new Map;e.loadTexture=function(t){if("string"==typeof t){var e=new Image;e.src=t,r.set(t,e)}},e.drawTexture=function(t,n,o,i){if(t!==e.NO_TEXTURE){var a=r.get(t);void 0!==a?n.drawImage(a,o.x-i.x/2,o.y-i.y/2,i.x,i.y):console.error("Texture not loaded",t)}}},7252:function(t,e){"use strict";var r=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},n=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.range=void 0,e.range=function(t){return n([],r(new Array(t).keys()),!1)}},422:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.seededRandom=void 0;var n=r(5908);e.seededRandom=function(t){return new n.Random((0,n.RNGFactory)(t))}},1183:function(t,e){"use strict";var r=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},n=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.sample=e.shuffle=e.shuffleInplace=void 0,e.shuffleInplace=function(t,e){for(var n,o=t.length;--o>0;){var i=e.integer(0,o);n=r([t[o],t[i]],2),t[i]=n[0],t[o]=n[1]}return t},e.shuffle=function(t,o){return(0,e.shuffleInplace)(n([],r(t),!1),o)},e.sample=function(t,r,n){return(0,e.shuffle)(r,n).slice(0,t)}},7785:(t,e,r)=>{"use strict";t.exports=r.p+"334d47fbf4d912b5c373.png"},9718:(t,e,r)=>{"use strict";t.exports=r.p+"4182604c2cd966f8e8f4.png"},6063:(t,e,r)=>{"use strict";t.exports=r.p+"61987ff5e2201c61bbdf.png"},5724:(t,e,r)=>{"use strict";t.exports=r.p+"a75a0e218874c047aeef.png"},8817:(t,e,r)=>{"use strict";t.exports=r.p+"63b2e2c9fd7f9a7d185a.png"},168:(t,e,r)=>{"use strict";t.exports=r.p+"7abebf054a41bcf79af3.png"},4365:(t,e,r)=>{"use strict";t.exports=r.p+"6446a54eccc014a9f2f1.png"},4787:(t,e,r)=>{"use strict";t.exports=r.p+"ce1dd9b95546eb80c018.png"},2655:(t,e,r)=>{"use strict";t.exports=r.p+"df185743c25070e92cfd.png"},6776:(t,e,r)=>{"use strict";t.exports=r.p+"bb385be04905527d5874.png"},6315:(t,e,r)=>{"use strict";t.exports=r.p+"b7fa75d03a727db772e8.world"},5042:()=>{},5908:(t,e,r)=>{"use strict";r.r(e),r.d(e,{RNG:()=>s,RNGFactory:()=>l,Random:()=>x,default:()=>w});var n=r(6377);function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,"symbol"==typeof(o=function(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key))?o:String(o)),n)}var o}function i(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,u(t,e)}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}var s=function(){function t(){}return t.prototype._seed=function(t,e){if(t===(t||0))return t;for(var r=""+t,n=0,o=0;o<r.length;++o)n^=0|r.charCodeAt(o);return n},t}(),c=function(t){function e(e,r){var n;return(n=t.call(this)||this)._rng=void 0,n.seed(e,r),n}a(e,t);var r=e.prototype;return r.next=function(){return this._rng()},r.seed=function(t,e){this._rng=t},r.clone=function(t,r){return new e(this._rng,r)},i(e,[{key:"name",get:function(){return"function"}}]),e}(s),l=function(){var t=[].slice.call(arguments),e=t[0],r=void 0===e?"default":e;switch(typeof r){case"object":if(r instanceof s)return r;break;case"function":return new c(r);default:return new c(n.apply(void 0,t))}throw new Error('invalid RNG "'+r+'"')},f=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),function(){return t.next()*(r-e)+e}};function h(t){return new d(t)}var d=function(t){var e=this;this.n=void 0,this.isInt=function(){if(Number.isInteger(e.n))return e;throw new Error("Expected number to be an integer, got "+e.n)},this.isPositive=function(){if(e.n>0)return e;throw new Error("Expected number to be positive, got "+e.n)},this.lessThan=function(t){if(e.n<t)return e;throw new Error("Expected number to be less than "+t+", got "+e.n)},this.greaterThanOrEqual=function(t){if(e.n>=t)return e;throw new Error("Expected number to be greater than or equal to "+t+", got "+e.n)},this.greaterThan=function(t){if(e.n>t)return e;throw new Error("Expected number to be greater than "+t+", got "+e.n)},this.n=t},p=function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),void 0===r&&(r=void 0===e?1:e,e=0),h(e).isInt(),h(r).isInt(),function(){return Math.floor(t.next()*(r-e+1)+e)}},v=function(t){return function(){return t.next()>=.5}},y=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],m=function(t){return y[t]},b=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var r=e.prototype;return r.next=function(){return Math.random()},r.seed=function(t,e){},r.clone=function(){return new e},i(e,[{key:"name",get:function(){return"default"}}]),e}(s),x=function(){function t(t){var e=this;this._rng=void 0,this._patch=void 0,this._cache={},this.next=function(){return e._rng.next()},this.float=function(t,r){return e.uniform(t,r)()},this.int=function(t,r){return e.uniformInt(t,r)()},this.integer=function(t,r){return e.uniformInt(t,r)()},this.bool=function(){return e.uniformBoolean()()},this.boolean=function(){return e.uniformBoolean()()},this.uniform=function(t,r){return e._memoize("uniform",f,t,r)},this.uniformInt=function(t,r){return e._memoize("uniformInt",p,t,r)},this.uniformBoolean=function(){return e._memoize("uniformBoolean",v)},this.normal=function(t,r){return function(t,e,r){return void 0===e&&(e=0),void 0===r&&(r=1),function(){var n,o,i;do{i=(n=2*t.next()-1)*n+(o=2*t.next()-1)*o}while(!i||i>1);return e+r*o*Math.sqrt(-2*Math.log(i)/i)}}(e,t,r)},this.logNormal=function(t,r){return function(t,e,r){void 0===e&&(e=0),void 0===r&&(r=1);var n=t.normal(e,r);return function(){return Math.exp(n())}}(e,t,r)},this.bernoulli=function(t){return function(t,e){return void 0===e&&(e=.5),h(e).greaterThanOrEqual(0).lessThan(1),function(){return Math.floor(t.next()+e)}}(e,t)},this.binomial=function(t,r){return function(t,e,r){return void 0===e&&(e=1),void 0===r&&(r=.5),h(e).isInt().isPositive(),h(r).greaterThanOrEqual(0).lessThan(1),function(){for(var n=0,o=0;n++<e;)t.next()<r&&o++;return o}}(e,t,r)},this.geometric=function(t){return function(t,e){void 0===e&&(e=.5),h(e).greaterThan(0).lessThan(1);var r=1/Math.log(1-e);return function(){return Math.floor(1+Math.log(t.next())*r)}}(e,t)},this.poisson=function(t){return function(t,e){if(void 0===e&&(e=1),h(e).isPositive(),e<10){var r=Math.exp(-e);return function(){for(var n=r,o=0,i=t.next();i>n;)i-=n,n=e*n/++o;return o}}var n=Math.sqrt(e),o=.931+2.53*n,i=.02483*o-.059,a=1.1239+1.1328/(o-3.4),u=.9277-3.6224/(o-2);return function(){for(;;){var r=void 0,s=t.next();if(s<=.86*u)return r=s/u-.43,Math.floor((2*i/(.5-Math.abs(r))+o)*r+e+.445);s>=u?r=t.next()-.5:(r=((r=s/u-.93)<0?-.5:.5)-r,s=t.next()*u);var c=.5-Math.abs(r);if(!(c<.013&&s>c)){var l=Math.floor((2*i/c+o)*r+e+.445);if(s=s*a/(i/(c*c)+o),l>=10){var f=(l+.5)*Math.log(e/l)-e-.9189385332046727+l-(1/12-(1/360-1/(1260*l*l))/(l*l))/l;if(Math.log(s*n)<=f)return l}else if(l>=0){var h,d=null!=(h=m(l))?h:0;if(Math.log(s)<=l*Math.log(e)-e-d)return l}}}}}(e,t)},this.exponential=function(t){return function(t,e){return void 0===e&&(e=1),h(e).isPositive(),function(){return-Math.log(1-t.next())/e}}(e,t)},this.irwinHall=function(t){return function(t,e){return void 0===e&&(e=1),h(e).isInt().greaterThanOrEqual(0),function(){for(var r=0,n=0;n<e;++n)r+=t.next();return r}}(e,t)},this.bates=function(t){return function(t,e){void 0===e&&(e=1),h(e).isInt().isPositive();var r=t.irwinHall(e);return function(){return r()/e}}(e,t)},this.pareto=function(t){return function(t,e){void 0===e&&(e=1),h(e).greaterThanOrEqual(0);var r=1/e;return function(){return 1/Math.pow(1-t.next(),r)}}(e,t)},t&&t instanceof s?this.use(t):this.use(new b),this._cache={}}var e=t.prototype;return e.clone=function(){var e=[].slice.call(arguments);return e.length?new t(l.apply(void 0,e)):new t(this.rng.clone())},e.use=function(){this._rng=l.apply(void 0,[].slice.call(arguments))},e.patch=function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()},e.unpatch=function(){this._patch&&(Math.random=this._patch,delete this._patch)},e.choice=function(t){if(!Array.isArray(t))throw new Error("Random.choice expected input to be an array, got "+typeof t);var e=null==t?void 0:t.length;return e>0?t[this.uniformInt(0,e-1)()]:void 0},e._memoize=function(t,e){var r=[].slice.call(arguments,2),n=""+r.join(";"),o=this._cache[t];return void 0!==o&&o.key===n||(o={key:n,distribution:e.apply(void 0,[this].concat(r))},this._cache[t]=o),o.distribution},i(t,[{key:"rng",get:function(){return this._rng}}]),t}(),w=new x}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&!t;)t=n[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),r.nc=void 0,(()=>{"use strict";var t=r(4569),e=r(118),n=r(4993),o=r(4345),i=r(2417),a=r(6301),u=r(7618),s=r(1716),c=r(5815),l=r(1811);r(8548);var f=document.getElementById("canvas");if(f instanceof HTMLCanvasElement){f.tabIndex=1e3,f.focus();var h={state:"mainMenu",canvas:f,context:f.getContext("2d"),previousUpdateTime:performance.now()},d=(0,l.EventBus)(h,e.CanvasClearEventHandler,t.InitEventHandler,s.MainMenuEventHandler,n.GameWorldEventHandler,(0,i.GameInterfaceEventHandler)(),(0,c.LevelUpEventHandler)(),u.PlayerDieEventHandler,(0,a.DebugInfoEventHandler)(),o.ChangePreviousUpdateTimeEventHandler);window.onload=function(t){d({type:"load",event:t}),setInterval((function(){d({type:"tick"})}),1e3/60)},window.onresize=function(t){d({type:"resize",event:t})},f.onkeydown=function(t){d({type:"keyDown",event:t})},f.onclick=function(t){d({type:"click",event:t})}}})()})();